var j=Object.defineProperty;var P=(e,l,t)=>l in e?j(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t;var r=(e,l,t)=>P(e,typeof l!="symbol"?l+"":l,t);import{_ as $}from"./iframe-DjmNRUro.js";import{j as b}from"./jsx-runtime-1FKYbnEZ.js";import{r as W}from"./index-prPvd6Su.js";import{a as G,P as L,b as H,u as w}from"./TableContext-ChDLO5uF.js";import{l as F,b as I,M as k,f as M,k as C,d as A,V as B,m as z}from"./ControlWrapper-D33h4I9C.js";import{g as Y,a as S}from"./util-DDtLIPUa.js";import{p as T,g as Q}from"./api-BLOSKcgX.js";import{p as J,g as X}from"./messageUtil-CQS9-IEm.js";import{g as Z}from"./script-wa9wuYzj.js";import{G as K}from"./Group-VVWCvCTc.js";import{M as ee}from"./Message-D5weHIvU.js";import{t as te}from"./index-CMxbcET4.js";import{q as ie}from"./omit-CSe7u5nZ.js";import{s as v}from"./pageContext-DllO6PNg.js";const g=[];for(let e=0;e<256;++e)g.push((e+256).toString(16).slice(1));function se(e,l=0){return(g[e[l+0]]+g[e[l+1]]+g[e[l+2]]+g[e[l+3]]+"-"+g[e[l+4]]+g[e[l+5]]+"-"+g[e[l+6]]+g[e[l+7]]+"-"+g[e[l+8]]+g[e[l+9]]+"-"+g[e[l+10]]+g[e[l+11]]+g[e[l+12]]+g[e[l+13]]+g[e[l+14]]+g[e[l+15]]).toLowerCase()}let R;const ne=new Uint8Array(16);function ae(){if(!R){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");R=crypto.getRandomValues.bind(crypto)}return R(ne)}const oe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),N={randomUUID:oe};function re(e,l,t){if(N.randomUUID&&!e)return N.randomUUID();e=e||{};const i=e.random??e.rng?.()??ae();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,se(i)}const le="Request time out while authenticating. Please try again.",ue="Request time out while getting accesstoken. Please try again.",D="Error occurred while trying to authenticate. Please try Again.",de="Authentication process interrupted. Please try again.",pe="Response not received from the expected sender. Please try again.",ce="[[any_other_value]]",he=(e,l,t,i)=>{const n={...i};return n.data?(n.data[t][e]=l,{changesOccured:!0,data:n}):{changesOccured:!1,data:n}},me=(e,l,t,i)=>{const n={...i};return n?.data?.[t]?(n.data[t].modifiedEntitiesData={...n.data[t].modifiedEntitiesData,[e]:l},{changesOccured:!0,data:n}):{changesOccured:!1,data:n}},fe=e=>!!((e.type==="text"||e.type==="textarea"||e.type==="singleSelect"||e.type==="multipleSelect"||e.type==="checkbox"||e.type==="radio"||e.type==="file")&&e?.modifyFieldsOnValue);function ge(e){return e.filter(t=>fe(t))}const ye=(e,l)=>{if(e==null||typeof l!="object"||!("pattern"in l))return!1;try{return new RegExp(l.pattern).test(e.toString())}catch(t){return console.error(`Invalid regex pattern: ${l.pattern}`,t),!1}},Ee=(e,l,t,i)=>{let n=e.modifyFieldsOnValue?.find(s=>{const d=l.data?.[e.field]?.value;return d!=null&&(d===s.fieldValue||F(d,i)===F(s.fieldValue,i)||ye(d,s.fieldValue))&&(!s.mode||s.mode===t)});return n||(n=e.modifyFieldsOnValue?.find(s=>s.fieldValue===ce&&(!s.mode||s.mode===t))),n},be=e=>e==="display"||e==="value"||e==="disabled"||e==="markdownMessage",ke=e=>e==="help"||e==="label"||e==="required",Ce=(e,l,t,i)=>be(e)?he(e,l,t,i):ke(e)&&(typeof l=="string"||typeof l=="boolean")?me(e,l,t,i):{changesOccured:!1,data:i},x=(e,l,t,i)=>{let n={...e},s=!1;return t.forEach(d=>{Ee(d,n,l,i)?.fieldsToModify.forEach(m=>{const{fieldId:p,...a}=m;Object.entries(a).forEach(([u,c])=>{const{data:f,changesOccured:y}=Ce(u,c,p,n);y&&(n=f,s=!0)})})}),{newState:n,shouldUpdateState:s}},q=(e,l,t,i,n)=>{const s={disabled:!1,error:!1,display:!0};if(e.type!=="helpLink"&&e.type!=="custom"){if(e.encrypted=e?.encrypted||!1,e.type==="file"&&l?.[e.field]&&(s.fileNameToDisplay="Previous File"),t.mode===I)return s.value=typeof e.defaultValue<"u"?e?.defaultValue:null,s.display=typeof e?.options?.display<"u"?e.options.display:!0,n&&(s.display=typeof e?.options?.display<"u"?e.options.display:n===i),s.display=v(e.options?.hideForPlatform,t.pageContext?.platform)?!1:s.display,s.error=!1,s.disabled=e?.options?.enable===!1,s;if(t.mode===k)return s.value=typeof l?.[e.field]<"u"?l?.[e.field]:null,s.value=e.encrypted?"":s.value,s.display=typeof e?.options?.display<"u"?e.options.display:!0,n&&(s.display=typeof e?.options?.display<"u"?e.options.display:n===i),s.display=v(e.options?.hideForPlatform,t.pageContext?.platform)?!1:s.display,s.error=!1,s.disabled=e?.options?.enable===!1,e.field==="name"?s.disabled=!0:typeof e?.options?.disableonEdit<"u"&&(s.disabled=e.options.disableonEdit),s;if(t.mode===M)return s.value=e.field==="name"||e.encrypted?"":l?.[e.field],s.display=typeof e?.options?.display<"u"?e.options.display:!0,n&&(s.display=typeof e?.options?.display<"u"?e.options.display:n===i),s.display=v(e.options?.hideForPlatform,t.pageContext?.platform)?!1:s.display,s.error=!1,s.disabled=e?.options?.enable===!1,s;if(t.mode===C)return e.defaultValue=typeof e.defaultValue<"u"?e.defaultValue:void 0,s.value=typeof l?.[e.field]<"u"?l?.[e.field]:e.defaultValue,s.value=e.encrypted?"":s.value,s.display=typeof e?.options?.display<"u"?e.options.display:!0,n&&(s.display=typeof e?.options?.display<"u"?e.options.display:n===i),s.display=v(e.options?.hideForPlatform,t.pageContext?.platform)?!1:s.display,s.error=!1,s.disabled=e?.options?.enable===!1,e.field==="name"?s.disabled=!0:typeof e?.options?.disableonEdit<"u"&&(s.disabled=e.options.disableonEdit),s;throw new Error(`Invalid mode : ${t.mode}`)}else return e.type==="custom"&&(s.value=l?.[e.field]),s},V=ie(ee)`
    margin-bottom: ${te.variables.spacingLarge};
`;function O(e){console.error(`[Custom Hook] Something went wrong while calling ${e.methodName}. Error: ${e.error?.name} ${e.error?.message}`)}class U extends W.PureComponent{constructor(t,i){super(t);r(this,"context");r(this,"flag");r(this,"currentInput");r(this,"appName");r(this,"restRoot");r(this,"groupEntities");r(this,"endpoint");r(this,"util");r(this,"onSavePromise");r(this,"utilControlWrapper");r(this,"groups");r(this,"entities");r(this,"options");r(this,"hookDeferred");r(this,"mode_config_title");r(this,"dependencyMap");r(this,"isOAuth");r(this,"isAuthVal");r(this,"authMap");r(this,"isoauthState");r(this,"isSingleOauth");r(this,"oauthConf");r(this,"datadict");r(this,"hook");r(this,"state_enabled");r(this,"oauth_state");r(this,"isCalled");r(this,"isError");r(this,"isResponse");r(this,"childWin");r(this,"customWarningMessage");r(this,"fieldsWithModifications");r(this,"inputsUniqueAcrossSingleService");r(this,"customComponentContext");r(this,"updateGroupEntities",()=>{this.groups&&this.groups.forEach(t=>{t.fields.forEach(i=>this.groupEntities.push(i))})});r(this,"handleSubmit",async t=>{if(t.preventDefault(),this.clearErrorMsg(),this.props.handleFormSubmit(!0,!1),this.datadict={},Object.keys(this.state.data||{}).forEach(n=>{this.datadict&&(this.datadict[n]=this.state?.data?.[n].value)}),this.hook&&typeof this.hook.onSave=="function"&&!await this.hook.onSave(this.datadict)){this.props.handleFormSubmit(!1,!1);return}const i=()=>{if(Object.keys(this.state.data||{}).forEach(o=>{this.datadict[o]=this.state?.data?.[o].value}),[I,M].includes(this.props.mode)){const o=()=>Object.keys(this.context?.rowData[this.props.serviceName]||{}).some(a=>a===this.datadict.name),m=()=>Object.values(this.context?.rowData||{}).some(a=>Object.keys(a).some(u=>u===this.datadict.name));if((this.inputsUniqueAcrossSingleService?o():m())&&this.entities){const a=this.entities.findIndex(u=>u.field==="name");if(a!==-1){const u=this.entities?.[a].label,c=this.datadict.name;u&&c&&typeof c!="object"&&this.setErrorFieldMsg("name",X(2,[u,String(c)]))}this.props.handleFormSubmit(!1,!1);return}}let n;if(this.isOAuth){let o=[];const m=[];Object.keys(this.authMap).forEach(p=>{p===this.datadict.auth_type||!this.isAuthVal?o=[...o,...this.authMap[p]]:m.push(...this.authMap[p])}),n=this.entities?.map(p=>p.type!=="helpLink"&&o.includes(p.field)?{required:!0,...p}:m.includes(p.field)?{...p,required:!1}:p)}else n=this.entities;n=n?.map(o=>{if(o.type==="helpLink")return o;const m=this.state?.data?.[o.field].modifiedEntitiesData?.required;return o?.type!=="oauth"&&o?.type!=="custom"&&o?.options?.requiredWhenVisible&&this?.state?.data?.[o.field].display?{...o,required:m??!0}:{...o,required:m??o.required}});let d=new B(n).doValidation(this.datadict);if(d){const o=d;this.setErrorFieldMsg(o?.errorField||"",o?.errorMsg||"")}else this.options&&this.options.saveValidator&&(d=z(this.options.saveValidator,this.datadict),d&&this.setErrorMsg(d.errorMsg||""));if(d)this.props.handleFormSubmit(!1,!1);else if(this.isOAuth&&(this.isSingleOauth||this.isAuthVal&&this.datadict.auth_type==="oauth")){let o=`?response_type=code&client_id=${this.datadict.client_id}&redirect_uri=${this.datadict.redirect_url}`;(this.isoauthState!=null?this.isoauthState:!1)===!0&&(this.state_enabled=!0,this.oauth_state=re().replace(/-/g,""),o=`${o}&state=${this.oauth_state}`),this.datadict.scope&&(o=`${o}&scope=${this.datadict.scope}`),this.oauthConf?.authEndpointAccessTokenType&&(o=`${o}&token_access_type=${this.oauthConf.authEndpointAccessTokenType}`);let p=encodeURI(`https://${this.datadict.endpoint||this.datadict.endpoint_authorize}${this.oauthConf?.authCodeEndpoint}${o}`);const a=new URLSearchParams(p).get("redirect_uri");a&&(p=p.replace(a,encodeURIComponent(a))),(async()=>(this.isCalled=!1,this.isError=!1,this.isResponse=!1,this.childWin=window.open(p,`${this.appName} OAuth`,`width=${this.oauthConf?.popupWidth}, height=${this.oauthConf?.popupHeight}`),window.getMessage=u=>{this.isCalled=!0,this.handleOauthToken(u)},await this.waitForAuthentication(this.oauthConf?.authTimeout||0),!this.isCalled&&this.childWin?.closed?(this.setErrorMsg(de),this.props.handleFormSubmit(!1,!1),!1):this.isCalled?(await this.waitForBackendResponse(30),!this.isResponse&&!this.isError?(this.isError=!0,this.setErrorMsg(ue),this.props.handleFormSubmit(!1,!1),!1):!0):(this.setErrorMsg(le),this.props.handleFormSubmit(!1,!1),!1)))().then(()=>{this.isError?this.props.handleFormSubmit(!1,!1):this.saveData()})}else this.saveData()};this.hook&&typeof this.hook.onSave=="function"&&typeof this.onSavePromise<"u"?this.onSavePromise.then(()=>{i()}):i()});r(this,"saveData",()=>{const t=new URLSearchParams;Object.keys(this.datadict).forEach(i=>{if(this.datadict[i]!=null)if(typeof this.datadict[i]=="object"&&this.entities?.find(n=>n?.field===i)?.type==="file"){const{fileContent:n}=this.datadict?.[i];t.append(i,n)}else this.datadict&&t.append(i,String(this.datadict[i]))}),this.isAuthVal&&Object.keys(this.authMap).forEach(i=>{this.datadict.auth_type!==i&&this.authMap[i].forEach(n=>{t.set(n,"")})}),this.isOAuth&&t.delete("redirect_url"),this.props.mode===k&&t.delete("name"),T({endpointUrl:Q(this.endpoint),body:t,handleError:!1}).then(i=>{const n=i?.entry[0];if(this.props.mode!==C){const s={};s[n.name]={...this.datadict,...n.content,id:n.id,name:n.name,serviceName:this.props.serviceName},this.context?.setRowData(w(this.context?.rowData,{[this.props.serviceName]:{$merge:s}}))}typeof this.hook?.onSaveSuccess=="function"&&this.hook.onSaveSuccess(),this.props.mode===k?S(`Updated "${n.name}"`,"success"):this.props.mode===C?S(`Updated "${this.mode_config_title?this.mode_config_title:n.name}"`,"success"):S(`Created "${n.name}"`,"success"),this.props.handleFormSubmit(!1,!0)}).catch(i=>{const n=J(i);this.setState({errorMsg:n}),this.hook&&typeof this.hook.onSaveFail=="function"&&this.hook.onSaveFail(),this.props.handleFormSubmit(!1,!1)})});r(this,"handleChange",(t,i)=>{this.setState(n=>{const s={};if(t==="auth_type"&&Object.keys(this.authMap).forEach(p=>{p===i?this.authMap[p].forEach(a=>{s[a]={display:{$set:!0}}}):this.authMap[p].forEach(a=>{s[a]={display:{$set:!1}}})}),this.dependencyMap.has(t)){const p=this.dependencyMap.get(t);Object.keys(p||{}).forEach(a=>{const u={};let c=!0;p?.[a].forEach(f=>{const y=!!this.entities?.find(h=>h.field===f)?.required,E=f===t?i:n?.data?.[f]?.value;y&&!E?(c=!1,u[f]=null):u[f]=E}),c&&(s[a]={dependencyValues:{$set:u},value:{$set:null}})})}s[t]={value:{$set:i}};const d=w(n,{data:s}),o=this.clearAllErrorMsg(d),{newState:m}=x(o,this.props.mode,this.fieldsWithModifications.filter(p=>p.field===t),this.props.page);return this.hookDeferred&&this.hookDeferred.then(()=>{typeof this.hook?.onChange=="function"&&this.hook.onChange(t,i,m)}),m})});r(this,"addCustomValidator",(t,i)=>{const n=this.entities?.findIndex(d=>d.field===t),s=[{type:"custom",validatorFunc:i}];n!==void 0&&this.entities?.[n]&&(this.entities[n].validators=s)});r(this,"setErrorFieldMsg",(t,i)=>{this.setState(n=>({...w(n,{data:{[t]:{error:{$set:!0}}}}),errorMsg:i}))});r(this,"clearErrorMsg",()=>{this.state.errorMsg&&this.setState(t=>({...t,errorMsg:""}))});r(this,"setErrorMsg",t=>{this.setState(i=>({...i,errorMsg:t}))});r(this,"clearAllErrorMsg",t=>{const i=t?{...t}:{...this.state};i.errorMsg="",i.warningMsg=this.customWarningMessage?.alwaysDisplay&&this.customWarningMessage?.message||"";const n=t?{...t.data}:{...this.state.data},s={};return Object.keys(n).forEach(d=>{n[d].error?s[d]={...n[d],error:!1}:s[d]=n[d]}),i.data=s,i});r(this,"generateErrorMessage",()=>this.state.errorMsg?b.jsx(V,{appearance:"fill",type:"error",children:this.state.errorMsg}):null);r(this,"generateWarningMessage",()=>this.state.warningMsg?b.jsx(V,{appearance:"fill",type:"warning",children:this.state.warningMsg}):null);r(this,"loadHook",(t,i,n)=>new Promise(d=>{const o=this.customComponentContext?.[t];if(o?.type==="hook"){const m=o.component;this.hook=new m(n,this.props.serviceName,this.state,this.props.mode,this.util,this.props.groupName),d(m)}else i==="external"&&$(()=>import(`${Z()}/custom/${t}.js`),[],import.meta.url).then(m=>{const p=m.default;this.hook=new p(n,this.props.serviceName,this.state,this.props.mode,this.util,this.props.groupName),d(p)})}));r(this,"handleOauthToken",t=>{if(!t||t&&t.error||t.code===void 0)return this.setErrorMsg(D),this.isError=!0,this.isResponse=!0,!1;const i=t.state;if(this.state_enabled===!0&&this.oauth_state!==i)return this.setErrorMsg(pe),this.isError=!0,this.isResponse=!0,!1;const n=new URL(`https://${this.datadict.endpoint||this.datadict.endpoint_token}`);n.pathname=this.oauthConf?.accessTokenEndpoint||"";const s=n.toString(),d=decodeURIComponent(t.code),o={method:"POST",url:s,grant_type:"authorization_code",client_id:this.datadict.client_id,client_secret:this.datadict.client_secret,code:d,redirect_uri:this.datadict.redirect_url};this.datadict.scope&&(o.scope=this.datadict.scope);const m=new URLSearchParams;Object.keys(o).forEach(a=>{const u=o[a];u&&m.append(a,String(u))});const p=`${encodeURIComponent(this.restRoot)}_oauth/oauth`;T({endpointUrl:p,body:m,handleError:!1}).then(a=>{if(a.entry[0].content.error===void 0){const u=a.entry[0].content.access_token,c=a.entry[0].content.instance_url,f=a.entry[0].content.refresh_token;return this.datadict.instance_url=c,this.datadict.refresh_token=f,this.datadict.access_token=u,this.isResponse=!0,!0}return this.setErrorMsg(a.entry[0].content.error),this.isError=!0,this.isResponse=!0,!1}).catch(()=>(this.setErrorMsg(D),this.isError=!0,this.isResponse=!0,!1))});r(this,"waitForAuthentication",async t=>{if(t-=1,this.isCalled===!0)return!0;if(t===0||this.childWin?.closed)return this.isError=!0,!1;await this.sleep(this.waitForAuthentication,t)});r(this,"waitForBackendResponse",async t=>{if(t+=1,this.isResponse===!0)return!0;if(t===60)return!1;await this.sleep(this.waitForBackendResponse,t)});r(this,"sleep",async(t,...i)=>(await this.timeout(1e3),t(...i)));r(this,"timeout",t=>new Promise(i=>setTimeout(i,t)));r(this,"renderGroupElements",()=>{let t=null;return this.groups&&this.groups.length&&(t=this.groups.map(i=>{const n=i.fields?.length&&i.fields.map(s=>this.entities?.map(d=>{if(d.field===s){const o=this.state?.data?.[d.field];return b.jsx(A,{utilityFuncts:this.utilControlWrapper,value:o?.value,display:typeof o?.display<"u"?o.display:!0,error:o?.error||!1,entity:d,serviceName:this.props.serviceName,mode:this.props.mode,disabled:o?.disabled||!1,markdownMessage:o?.markdownMessage,dependencyValues:o?.dependencyValues||null,page:this.props.page,fileNameToDisplay:o.fileNameToDisplay,modifiedEntitiesData:o.modifiedEntitiesData},d.field)}return null}));return b.jsx(K,{isExpandable:i.options?.isExpandable,defaultOpen:i.options?.expand,title:i.label,children:n},i.label)})),t});this.flag=!0,this.state={data:{}},this.datadict={},this.currentInput={};const n=Y();this.appName=n.meta.name,this.restRoot=n.meta.restRoot,this.groupEntities=[],this.endpoint=t.mode===k||t.mode===C?`${encodeURIComponent(this.props.serviceName)}/${encodeURIComponent(this.props.stanzaName)}`:`${encodeURIComponent(this.props.serviceName)}`,this.util={setState:a=>{this.onSavePromise=new Promise(u=>{this.setState(c=>a(c),()=>u(!0))})},setErrorFieldMsg:this.setErrorFieldMsg,clearAllErrorMsg:this.clearAllErrorMsg,setErrorMsg:this.setErrorMsg},this.utilControlWrapper={handleChange:this.handleChange,addCustomValidator:this.addCustomValidator,utilCustomFunctions:this.util},this.customWarningMessage={message:""},this.customComponentContext=this.props.customComponentContext,t.page===L?(this.inputsUniqueAcrossSingleService=n.pages?.inputs?.inputsUniqueAcrossSingleService,n.pages?.inputs?.services.forEach(a=>{a.name===t.serviceName&&(this.groups=a.groups,this.entities=a.entity,this.updateGroupEntities(),this.options=a.options,a.hook&&(this.hookDeferred=this.loadHook(a.hook.src,a.hook.type,n)),(t.mode===k||t.mode===M)&&i&&(this.currentInput=i?.rowData?.[t.serviceName]?.[t.stanzaName]),t.mode!=="delete"&&(this.customWarningMessage=a?.warning?.[t.mode]||{message:""}))})):(n.pages.configuration?.tabs??[]).forEach(a=>{(a.table?a.name===t.serviceName:a.name===t.stanzaName&&t.serviceName==="settings")&&(this.groups=a.groups,this.updateGroupEntities(),this.entities=a.entity,this.options=a.options,t.mode!=="delete"&&(this.customWarningMessage=a?.warning?.[t.mode]||{message:""}),a.hook&&(this.hookDeferred=this.loadHook(a.hook.src,a.hook.type,n)),a.table&&(t.mode===k||t.mode===M)?i&&(this.currentInput=i?.rowData?.[t.serviceName]?.[t.stanzaName]):t.mode===C?(t.currentServiceState&&(this.currentInput=t.currentServiceState),this.mode_config_title=a.title):i&&(this.currentInput=i?.rowData?.[t.serviceName]))}),this.dependencyMap=new Map,this.isOAuth=!1,this.isAuthVal=!1,this.authMap={};let s={};const d=[];this.entities?.forEach(a=>{if(a.type==="oauth"){if(this.isOAuth=!0,t.page===H){const u=a?.options?.auth_type;if(this.isoauthState=typeof a?.options?.oauth_state_enabled<"u"?a?.options?.oauth_state_enabled:null,u.length>1){this.isAuthVal=!0;const f={disabled:!1,error:!1,display:!0,value:u.find(h=>h===this.currentInput?.auth_type)||u[0]};s.auth_type=f;const y={basic:"Basic Authentication",oauth:"OAuth 2.0 - Authorization Code Grant Type",oauth_client_credentials:"OAuth 2.0 - Client Credentials Grant Type"},E={field:"auth_type",type:"singleSelect",label:"Auth Type",options:{hideClearBtn:!0,autoCompleteFields:u.map(h=>typeof h=="object"?h:{label:a?.options?.oauth_type_labels?.[h]||y[h]||h,value:h})}};d.push(E)}else this.isSingleOauth=u.includes("oauth");if(u?.forEach(c=>{const f=[],y=c,E=a?.options[y];E&&(E.forEach(h=>{if(!h)return;const _=q(h,this.currentInput,this.props,u.length>1?s?.auth_type?.value:u[0],c);s[h.field]=_,h.type=h?.type||"text",h.required=typeof h?.required<"u"?h?.required:!0,h.field==="redirect_url"&&(_.value=window.location.href.split("?")[0].replace("configuration",`${this.appName.toLowerCase()}_redirect`),_.disabled=!0),d.push(h),f?.push(h.field)}),this.authMap[y]=f)}),u.includes("oauth")){const c={popupWidth:a?.options?.oauth_popup_width||600,popupHeight:a?.options?.oauth_popup_height||600,authTimeout:a?.options?.oauth_timeout||180,authCodeEndpoint:a?.options?.auth_code_endpoint||null,accessTokenEndpoint:a?.options?.access_token_endpoint||null,authEndpointAccessTokenType:a?.options?.auth_endpoint_token_access_type||null};this.oauthConf=c}}}else{if(s[a.field]=q(a,this.currentInput,this.props),a.type==="singleSelect"||a.type==="multipleSelect"){const u=a.options?.dependencies;u&&u.forEach(c=>{const f=this.dependencyMap.get(c);f&&typeof a.field=="string"?f[a.field]=u:this.dependencyMap.set(c,{[a.field]:u})})}d.push(a)}}),this.entities=d;let o={};this.dependencyMap.forEach(a=>{o={...o,...a}});const m={};Object.keys(o).forEach(a=>{const u=o[a],c={};let f=!0;u.forEach(y=>{const E=!!this.entities?.find(_=>_.field===y)?.required,h=s[y]?.value;E&&!h?(f=!1,c[y]=null):c[y]=h}),f&&(m[a]={dependencyValues:{$set:c}})}),s=w(s,m),this.fieldsWithModifications=ge(this.entities);const p=x({data:s},this.props.mode,this.fieldsWithModifications,this.props.page);p.shouldUpdateState&&(s={...p.newState.data}),this.state={data:s,errorMsg:"",warningMsg:this.customWarningMessage?.message||""},this.hookDeferred&&this.hookDeferred.then(()=>{if(typeof this.hook?.onCreate=="function")try{this.hook.onCreate()}catch(a){O({methodName:"onCreate",error:a})}})}render(){return this.flag&&(this.hookDeferred&&this.hookDeferred.then(()=>{if(typeof this.hook?.onRender=="function")try{this.hook.onRender()}catch(t){O({methodName:"onRender",error:t})}}),this.props.mode===k&&this.hookDeferred&&this.hookDeferred.then(()=>{if(typeof this.hook?.onEditLoad=="function")try{this.hook.onEditLoad()}catch(t){O({methodName:"onEditLoad",error:t})}}),this.flag=!1),b.jsx("div",{children:b.jsxs("form",{onSubmit:this.handleSubmit,style:this.props.mode===C?{marginTop:"25px"}:{},children:[this.generateWarningMessage(),this.generateErrorMessage(),this.entities?.map(t=>{if(this.groupEntities.includes(t.field))return null;const i=this.state?.data?.[t.field];return i?b.jsx(A,{utilityFuncts:this.utilControlWrapper,value:i.value,display:i.display,error:i.error,entity:t,serviceName:this.props.serviceName,mode:this.props.mode,disabled:i.disabled,markdownMessage:i.markdownMessage,dependencyValues:i.dependencyValues||null,fileNameToDisplay:i.fileNameToDisplay,modifiedEntitiesData:i.modifiedEntitiesData,page:this.props.page},t.field):null}),this.renderGroupElements()]})})}}r(U,"contextType",G);U.__docgenInfo={description:"",methods:[{name:"updateGroupEntities",docblock:null,modifiers:[],params:[],returns:null},{name:"handleSubmit",docblock:null,modifiers:["async"],params:[{name:"event",optional:!1,type:{name:"union",raw:"React.MouseEvent | React.FormEvent",elements:[{name:"ReactMouseEvent",raw:"React.MouseEvent"},{name:"ReactFormEvent",raw:"React.FormEvent"}]}}],returns:null},{name:"saveData",docblock:null,modifiers:[],params:[],returns:null},{name:"handleChange",docblock:null,modifiers:[],params:[{name:"field",optional:!1,type:{name:"string"}},{name:"targetValue",optional:!1,type:{name:"union",raw:"AcceptableFormValueOrNull | undefined",elements:[{name:"union",raw:"AcceptableFormValue | null",elements:[{name:"union",raw:"string | number | boolean | { fileContent?: string }",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"signature",type:"object",raw:"{ fileContent?: string }",signature:{properties:[{key:"fileContent",value:{name:"string",required:!1}}]}}]},{name:"null"}]},{name:"undefined"}],alias:"AcceptableFormValueOrNullish"}}],returns:null},{name:"addCustomValidator",docblock:null,modifiers:[],params:[{name:"field",optional:!1,type:{name:"string"}},{name:"validatorFunc",optional:!1,type:{name:"signature",type:"function",raw:`(
    submittedField: string,
    submittedValue: AcceptableFormValueOrNullish
) => string | boolean | undefined`,signature:{arguments:[{type:{name:"string"},name:"submittedField"},{type:{name:"union",raw:"AcceptableFormValueOrNull | undefined",elements:[{name:"union",raw:"AcceptableFormValue | null",elements:[{name:"union",raw:"string | number | boolean | { fileContent?: string }",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"signature",type:"object",raw:"{ fileContent?: string }",signature:{properties:[{key:"fileContent",value:{name:"string",required:!1}}]}}]},{name:"null"}]},{name:"undefined"}]},name:"submittedValue"}],return:{name:"union",raw:"string | boolean | undefined",elements:[{name:"string"},{name:"boolean"},{name:"undefined"}]}},alias:"CustomValidatorFunc"}}],returns:null},{name:"setErrorFieldMsg",docblock:null,modifiers:[],params:[{name:"field",optional:!1,type:{name:"string"}},{name:"msg",optional:!1,type:{name:"string"}}],returns:null},{name:"clearErrorMsg",docblock:null,modifiers:[],params:[],returns:null},{name:"setErrorMsg",docblock:null,modifiers:[],params:[{name:"msg",optional:!1,type:{name:"string"}}],returns:null},{name:"clearAllErrorMsg",docblock:null,modifiers:[],params:[{name:"State",optional:!1,type:{name:"BaseFormState",alias:"BaseFormState"}}],returns:null},{name:"generateErrorMessage",docblock:null,modifiers:[],params:[],returns:null},{name:"generateWarningMessage",docblock:null,modifiers:[],params:[],returns:null},{name:"loadHook",docblock:null,modifiers:[],params:[{name:"module",optional:!1,type:{name:"string"}},{name:"type",optional:!1,type:{name:"string"}},{name:"globalConfig",optional:!1,type:{name:"z.infer",elements:[{name:"GlobalConfigSchema"}],raw:"z.infer<typeof GlobalConfigSchema>",alias:"GlobalConfig"}}],returns:null},{name:"handleOauthToken",docblock:null,modifiers:[],params:[{name:"message",optional:!1,type:{name:"signature",type:"object",raw:"{ code: string; error: unknown; state?: string }",signature:{properties:[{key:"code",value:{name:"string",required:!0}},{key:"error",value:{name:"unknown",required:!0}},{key:"state",value:{name:"string",required:!1}}]}}}],returns:null},{name:"waitForAuthentication",docblock:null,modifiers:["async"],params:[{name:"count",optional:!1,type:{name:"number"}}],returns:null},{name:"waitForBackendResponse",docblock:null,modifiers:["async"],params:[{name:"count",optional:!1,type:{name:"number"}}],returns:null},{name:"sleep",docblock:null,modifiers:["async"],params:[{name:"fn",optional:!1,type:{name:"signature",type:"function",raw:"(...someArgs: number[]) => unknown",signature:{arguments:[{type:{name:"Array",elements:[{name:"number"}],raw:"number[]"},name:"someArgs",rest:!0}],return:{name:"unknown"}}}},{name:"...args",optional:!1,type:{name:"Array",elements:[{name:"number"}],raw:"number[]"}}],returns:null},{name:"timeout",docblock:null,modifiers:[],params:[{name:"ms",optional:!1,type:{name:"number"}}],returns:null},{name:"renderGroupElements",docblock:null,modifiers:[],params:[],returns:null}],displayName:"BaseFormView",props:{currentServiceState:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"union",raw:"AcceptableFormValue | null",elements:[{name:"union",raw:"string | number | boolean | { fileContent?: string }",elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"signature",type:"object",raw:"{ fileContent?: string }",signature:{properties:[{key:"fileContent",value:{name:"string",required:!1}}]}}]},{name:"null"}]}],raw:"Record<string, AcceptableFormValueOrNull>"},description:""},serviceName:{required:!0,tsType:{name:"string"},description:""},mode:{required:!0,tsType:{name:"union",raw:`| typeof MODE_CLONE
| typeof MODE_CREATE
| typeof MODE_DELETE
| typeof MODE_EDIT
| typeof MODE_CONFIG`,elements:[{name:"MODE_CLONE"},{name:"MODE_CREATE"},{name:"MODE_DELETE"},{name:"MODE_EDIT"},{name:"MODE_CONFIG"}]},description:""},page:{required:!0,tsType:{name:"union",raw:"'configuration' | 'inputs'",elements:[{name:"literal",value:"'configuration'"},{name:"literal",value:"'inputs'"}]},description:""},stanzaName:{required:!0,tsType:{name:"string"},description:""},groupName:{required:!1,tsType:{name:"string"},description:""},handleFormSubmit:{required:!0,tsType:{name:"signature",type:"function",raw:"(isSubmitting: boolean, closeEntity: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isSubmitting"},{type:{name:"boolean"},name:"closeEntity"}],return:{name:"void"}}},description:""},pageContext:{required:!1,tsType:{name:"signature",type:"object",raw:`{
    platform: Platforms;
}`,signature:{properties:[{key:"platform",value:{name:"union",raw:"'enterprise' | 'cloud' | undefined",elements:[{name:"literal",value:"'enterprise'"},{name:"literal",value:"'cloud'"},{name:"undefined"}],required:!0}}]}},description:""},customComponentContext:{required:!1,tsType:{name:"union",raw:"CustomElementsMap | undefined",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:`| CustomHookStructure
| CustomControlStructure
| CustomRowStructure
| CustomCellStructure
| CustomTabStructure`,elements:[{name:"signature",type:"object",raw:`{
    component: CustomHookConstructor;
    type: 'hook';
}`,signature:{properties:[{key:"component",value:{name:"unknown",required:!0}},{key:"type",value:{name:"literal",value:"'hook'",required:!0}}]}},{name:"signature",type:"object",raw:`{
    component: CustomControlConstructor;
    type: 'control';
}`,signature:{properties:[{key:"component",value:{name:"unknown",required:!0}},{key:"type",value:{name:"literal",value:"'control'",required:!0}}]}},{name:"signature",type:"object",raw:`{
    component: CustomRowConstructor;
    type: 'row';
}`,signature:{properties:[{key:"component",value:{name:"unknown",required:!0}},{key:"type",value:{name:"literal",value:"'row'",required:!0}}]}},{name:"signature",type:"object",raw:`{
    component: CustomCellConstructor;
    type: 'cell';
}`,signature:{properties:[{key:"component",value:{name:"unknown",required:!0}},{key:"type",value:{name:"literal",value:"'cell'",required:!0}}]}},{name:"signature",type:"object",raw:`{
    component: CustomTabConstructor;
    type: 'tab';
}`,signature:{properties:[{key:"component",value:{name:"unknown",required:!0}},{key:"type",value:{name:"literal",value:"'tab'",required:!0}}]}}]}],raw:`Record<
    string,
    | CustomHookStructure
    | CustomControlStructure
    | CustomRowStructure
    | CustomCellStructure
    | CustomTabStructure
>`},{name:"undefined"}]},description:""}}};export{U as B};
