import{u as g,c as h,f as u}from"./url-xolDOGfA.js";import{g as l,a as E}from"./util-DDtLIPUa.js";import{p,R as m}from"./messageUtil-CQS9-IEm.js";function U(o){return`${l().meta.restRoot}_${o}`}const w={output_mode:"json"};function i(o,e){const r=new URL(g.createRESTURL(o,{app:h.app,owner:"nobody"}),window.location.origin);return Object.entries({...w,...e}).filter(([,n])=>n!=null).forEach(([n,s])=>r.searchParams.append(n,s.toString())),r}async function R(o){const e=await o.json(),r=p(e);throw new m({response:o,message:r})}async function c(o,e,r,n){const s=u.getDefaultFetchInit();try{const t=await fetch(o.toString(),{...s,...e});return t.ok||await R(t),await t.json()}catch(t){const a=t instanceof DOMException&&t.name==="AbortError";if(r&&!a){const f=p(t);E(f,"error"),n&&n(t)}throw t}}async function A({endpointUrl:o,params:e={},signal:r,handleError:n,callbackOnError:s}){const t=i(o,e);return c(t,{method:"GET",signal:r},n,s)}async function I({endpointUrl:o,params:e={},body:r,signal:n,handleError:s,callbackOnError:t}){const a=i(o,e),d={method:"POST",headers:{...u.getDefaultFetchInit().headers,"Content-Type":"application/x-www-form-urlencoded"},signal:n,body:r};return c(a,d,s,t)}async function S({endpointUrl:o,params:e={},signal:r,handleError:n,callbackOnError:s}){const t=i(o,e);return c(t,{method:"DELETE",signal:r},n,s)}export{A as a,S as d,U as g,I as p};
