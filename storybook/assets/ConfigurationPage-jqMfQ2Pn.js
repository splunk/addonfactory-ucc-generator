import{j as e}from"./jsx-runtime-1FKYbnEZ.js";import{r as s,R as U}from"./index-prPvd6Su.js";import{i as C}from"./messageUtil-CvmCOD_s.js";import{u as B,a as M,T as v,b as F}from"./usePlatform-B4VghJKE.js";import{h as w,k as $,b as P,f as z,g as b}from"./ControlWrapper-C-3SaADr.js";import{q as x}from"./omit-UcH284-_.js";import{g as N,i as V}from"./util-BVaVe7dF.js";import{E as W,T as G,S as H}from"./EntityPage-BdiuKLGt.js";import{E as Q}from"./ErrorBoundary-oRjb1fsE.js";import{_ as Y}from"./iframe-D1ZpU7rR.js";import{g as O}from"./script-ClADN3Yb.js";import{P as E}from"./index-BbiZmkAC.js";import{B as J}from"./BaseFormView-dsmNhTgc.js";import{U as K}from"./UCCButton-IGhfY3sr.js";import{a as X,g as Z}from"./api-BXYB3TVR.js";import{W as ee}from"./CustomTableStyle-4srtNYm5.js";import{b as j,T as te}from"./TableContext-gysp-n-m.js";import{a as ne,P as oe}from"./PageContext-DhAckcxo.js";import{S as se,T as re,a as ae}from"./TableWrapper-BeDoGR6W.js";import{E as ie}from"./EntityModal-Dj1UFiw1.js";import{D as le}from"./DownloadButton-B2zx_yAZ.js";import{S as me}from"./SubDescription-4r8vjCf1.js";import{L as pe}from"./Link-ooEZC2Mq.js";import{s as ce}from"./pageContext-DllO6PNg.js";const I=({tab:t})=>{const p=s.useContext(w),[o,c]=s.useState(!0),i=s.useRef(null),f=()=>new Promise(r=>{const u=t?.customTab?.src?p?.[t?.customTab?.src]:void 0;if(u?.type==="tab"){const l=u.component;r(l)}else t.customTab?.type==="external"&&Y(()=>import(`${O()}/custom/${t.customTab.src}.js`),[],import.meta.url).then(l=>{const d=l.default;r(d)})});return s.useEffect(()=>{f().then(r=>{i.current&&(new r(t,i.current).render(),c(!1))})},[]),e.jsxs(e.Fragment,{children:[o&&C._("Loading..."),e.jsx("div",{ref:i,style:{visibility:o?"hidden":"visible"}})]})};I.__docgenInfo={description:"",methods:[],displayName:"CustomTab",props:{tab:{required:!0,tsType:{name:"z.infer",elements:[{name:"TabSchema"}],raw:"z.infer<typeof TabSchema>"},description:""}}};const ue=x.div`
    margin-left: 270px !important;
    width: 150px;
`;function S({serviceName:t}){const p=s.useRef(),[o,c]=s.useState(null),[i,f]=s.useState(!1),[r,u]=s.useState({});s.useEffect(()=>{const a=new AbortController;return X({endpointUrl:Z(`settings/${encodeURIComponent(t)}`),handleError:!0,signal:a.signal,callbackOnError:m=>{a.signal.aborted||c(m)}}).catch(m=>{if(a.signal.aborted)return null;throw m}).then(m=>{m&&u(m.entry[0].content)}),()=>{a.abort()}},[t]);const l=a=>{p.current.handleSubmit(a)},d=a=>{f(a)};if(o)throw o;return Object.keys(r).length?e.jsxs(e.Fragment,{children:[e.jsx(w.Consumer,{children:a=>e.jsx(ne.Consumer,{children:m=>e.jsx(J,{ref:p,page:j,stanzaName:t,serviceName:"settings",mode:$,currentServiceState:r,handleFormSubmit:d,pageContext:m,customComponentContext:a})})}),e.jsx(ue,{children:e.jsx(K,{className:"saveBtn",label:C._("Save"),onClick:l,loading:i})})]}):e.jsx(ee,{size:"medium"})}S.propTypes={serviceName:E.string.isRequired};S.__docgenInfo={description:"",methods:[],displayName:"ConfigurationFormView",props:{serviceName:{description:"",type:{name:"string"},required:!0}}};function _({selectedTab:t,updateIsPageOpen:p}){const[o,c]=s.useState({open:!1}),i=t.style===se;s.useEffect(()=>{i&&p(!!o.open)},[p,i,o]);const f=()=>{c({...o,open:!0,mode:P,formLabel:t.formTitle?`Add ${t.formTitle}`:`Add ${t.title}`})},r=()=>{c({...o,open:!1})},u=()=>e.jsx(ie,{page:j,open:o.open,handleRequestClose:r,returnFocus:()=>{},serviceName:t.name,mode:P,formLabel:o.formLabel}),l=(y,T)=>{const g=t?.formTitle||t.title;c({...o,open:!0,stanzaName:y.name,formLabel:T===z?`Clone ${g}`:`Update ${g}`,mode:T})},d=()=>{c({...o,open:!1})},a=()=>e.jsx(W,{open:o.open,handleRequestClose:d,serviceName:t.name,stanzaName:o.stanzaName,mode:o.mode,formLabel:o.formLabel,page:j}),m=()=>e.jsx("div",{style:i&&o.open?{display:"none"}:{display:"block"},children:e.jsx(re,{page:j,serviceName:t.name,handleRequestModalOpen:()=>f(),handleOpenPageStyleDialog:l})});return e.jsxs(te,{value:null,children:[i&&o.open&&a(),m(),!i&&o.open&&u()]})}_.propTypes={selectedTab:E.object,updateIsPageOpen:E.func};const de=s.memo(_);_.__docgenInfo={description:"",methods:[],displayName:"ConfigurationTable",props:{selectedTab:{description:"",type:{name:"object"},required:!1},updateIsPageOpen:{description:"",type:{name:"func"},required:!1}}};const fe=O().replace("js/build","openapi.json");function R(){return e.jsx(le,{fileUrl:fe,fileNameAfterDownload:"openapi.json",children:"OpenAPI.json"})}R.__docgenInfo={description:"",methods:[],displayName:"OpenApiDownloadButton"};const ge=x(ae.Typography)`
    font-size: 0.8em;
`,D=()=>{const t=N();if(t?.meta?.hideUCCVersion)return null;const p=t?.meta?._uccVersion??null;return e.jsxs(ge,{as:"span",title:"Splunk Add-On UCC framework is a framework to generate UI-based Splunk add-ons. It includes UI, REST handlers, Modular inputs, OAuth and Alert action templates.","data-test":"ucc-credit",children:["Made with"," ",e.jsx(pe,{to:"https://splunk.github.io/addonfactory-ucc-generator/",openInNewContext:!0,children:"UCC"})," ",p]})};D.__docgenInfo={description:"",methods:[],displayName:"UccCredit"};const he=x.div`
    display: inline-flex;
    align-items: center;
    justify-content: end;
    flex-wrap: wrap;
    gap: 0.4rem;
`,Ce=x(b.Row)`
    padding: 5px 0px;

    .dropdown {
        text-align: right;
    }

    .input_button {
        text-align: right;
        margin-right: 0px;
    }
`,xe=x(v)`
    flex-wrap: wrap;
`;function ye(){const t=N();V(t.pages.configuration,"Configuration page not found in global config");const{title:p,description:o,subDescription:c,tabs:i}=t.pages.configuration,f=B(t,"configuration"),r=i.filter(n=>!ce(n.hideForPlatform,f)),u=s.useMemo(()=>r.map(n=>n.name),[r]),l=s.useRef(!1),[d,a]=s.useState(r[0].name),[m,y]=s.useState(!1),g=M()?.get("tab");s.useEffect(()=>{g&&u.includes(g)&&g!==d&&a(g)},[g,u,d]),s.useEffect(()=>(l.current=!0,()=>{l.current=!1}),[]);const k=s.useCallback((n,{selectedTabId:h})=>{l.current&&h&&(a(h),y(!1))},[]),A=n=>{l.current&&y(n)},q=n=>U.createElement(I,{tab:n}),L=n=>{let h;return n?.customTab?h=q(n):h=n?.table?e.jsx(de,{selectedTab:n,updateIsPageOpen:A},n.name):e.jsx(S,{serviceName:n.name},n.name),e.jsx("div",{style:n.name!==d?{display:"none"}:{display:"block"},id:`${n.name}Tab`,children:h},n.name)};return e.jsx(Q,{children:e.jsxs(oe,{platform:f,children:[e.jsxs("div",{style:m?{display:"none"}:{display:"block"},children:[e.jsx(b,{gutter:8,children:e.jsxs(Ce,{children:[e.jsxs(b.Column,{span:9,children:[e.jsx(G,{children:C._(p)}),e.jsx(H,{children:C._(o||"")}),e.jsx(me,{text:c?.text||"",links:c?.links})]}),e.jsx(b.Column,{span:3,style:{textAlignLast:"right"},children:e.jsxs(he,{children:[e.jsx(D,{}),e.jsx(R,{})]})})]})}),e.jsx(xe,{activeTabId:d,onChange:k,children:r.map(n=>e.jsx(v.Tab,{label:C._(n.title),tabId:n.name},n.name))})]}),r.map(n=>L(n)),e.jsx(F,{position:"top-right"})]})})}ye.__docgenInfo={description:"",methods:[],displayName:"ConfigurationPage"};export{ye as C};
