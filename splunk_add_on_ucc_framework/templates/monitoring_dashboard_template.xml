<form script="{{addon_name}}:tabs.js" stylesheet="{{addon_name}}:tabs.css" version="1.1">
    <label>Monitoring Dashboard</label>
    <description>Monitoring the health and ingestion of this TA. More description.</description>
    <row>
        <panel id="overview_info_panel">
            <html>Overview</html>
            <search>
                <query>
                    | makeresults
                    | addinfo
                    | eval StartDate = strftime(info_min_time, "%b %e,%Y %I:%M%p"), EndDate = strftime(info_max_time,
                    "%b %e,%Y %I:%M%p")
                </query>
                <earliest>$overview_time.earliest$</earliest>
                <latest>$overview_time.latest$</latest>
                <done>
                    <set token="overview_start">$result.StartDate$</set>
                    <set token="overview_end">$result.EndDate$</set>
                </done>
            </search>
            <html>$overview_start$ - $overview_end$</html>
        </panel>
        <panel id="overview_input_panel">
            <input id="overview_input" type="time" token="overview_time">
                <label>Time:</label>
                <default>
                    <earliest>-7d</earliest>
                    <latest>now</latest>
                </default>
            </input>
        </panel>
    </row>
    <row>
        <panel>
            <title>Data ingestion</title>
            <chart>
                <search>
                    <query>{{ data_ingestion }}</query>
                    <earliest>$overview_time.earliest$</earliest>
                    <latest>$overview_time.latest$</latest>
                </search>
                <option name="charting.chart">column</option>
                <option name="charting.axisTitleY.text">Volume[GB]</option>
                <option name="charting.drilldown">none</option>
            </chart>
        </panel>
        <panel>
            <title>Errors</title>
            <chart>
                <search>
                    <query>{{ errors_chart }}</query>
                    <earliest>$overview_time.earliest$</earliest>
                    <latest>$overview_time.latest$</latest>
                </search>
                <option name="charting.chart">line</option>
                <option name="charting.drilldown">none</option>
            </chart>
        </panel>
    </row>
    <row id="tabs_row">
        <panel id="tabs_panel">
            <html>
                <ul id="tabs" class="nav nav-tabs">
                    <li class="active">
                        <a href="#" class="toggle-tab" data-toggle="tab"
                           data-elements="data_ingestion_input_row,tab_data_ingestion,tab_data_ingestion_table,table_row">
                            Data
                            ingestion
                        </a>
                    </li>
                    <li>
                        <a href="#" class="toggle-tab" data-toggle="tab" data-elements="error_tab_row,error_tab_row,error_tab_info_row">
                            Errors
                        </a>
                    </li>
                </ul>
            </html>
        </panel>
    </row>
    <row id="data_ingestion_input_row">
        <panel id="data_ingestion_input_label_panel">
            <html>Data ingestion</html>
            <html>Monitor the total data ingestion to stack</html>
            <search>
                <query>
                    | makeresults
                    | addinfo
                    | eval StartDate = strftime(info_min_time, "%b %e,%Y %I:%M%p"), EndDate = strftime(info_max_time,
                    "%b %e,%Y %I:%M%p")
                </query>
                <earliest>$data_ingestion_time.earliest$</earliest>
                <latest>$data_ingestion_time.latest$</latest>
                <done>
                    <set token="data_ingestion_start">$result.StartDate$</set>
                    <set token="data_ingestion_end">$result.EndDate$</set>
                </done>
            </search>
            <html>$data_ingestion_start$ - $data_ingestion_end$</html>
        </panel>
        <panel id="data_ingestion_input_panel">
            <input id="data_ingestion_input" type="time" token="data_ingestion_time">
                <label>Time:</label>
                <default>
                    <earliest>-7d</earliest>
                    <latest>now</latest>
                </default>
            </input>
        </panel>
    </row>
    <row id="tab_data_ingestion">
        <panel>
            <title>Data volume</title>
            <chart>
                <search>
                    <query>{{ data_ingestion }}</query>
                    <earliest>$data_ingestion_time.earliest$</earliest>
                    <latest>$data_ingestion_time.latest$</latest>
                </search>
                <option name="charting.chart">line</option>
                <option name="charting.axisTitleY.text">Volume[GB]</option>
                <option name="charting.drilldown">none</option>
            </chart>
        </panel>
        <panel>
            <title>Events count</title>
            <chart>
                <search>
                    <query>{{ events_count }}</query>
                    <earliest>$data_ingestion_time.earliest$</earliest>
                    <latest>$data_ingestion_time.latest$</latest>
                </search>
                <option name="charting.chart">line</option>
                <option name="charting.drilldown">none</option>
            </chart>
        </panel>
    </row>
    <row id="table_row">
        <panel id="table_input_panel">
            <input id="table_input" type="dropdown" token="droptablevalue">
                <label>View by</label>
                <default>Source type</default>
                <choice value='{{ table_sourcetype }}'>Source type</choice>
                <choice value='{{ table_source }}'>Source</choice>
                <choice value='{{ table_host }}'>Host</choice>
                <choice value='{{ table_index }}'>Index</choice>
            </input>
        </panel>
    </row>
    <row id="tab_data_ingestion_table">
        <panel>
            <table>
                <search>
                    <query>$droptablevalue$</query>
                    <earliest>$data_ingestion_time.earliest$</earliest>
                    <latest>$data_ingestion_time.latest$</latest>
                </search>
            </table>
        </panel>
    </row>
    <row id="error_tab_info_row">
        <panel id="error_tab_info_panel">
            <html>Errors</html>
            <html>Monitor the total errors of this TA</html>
            <search>
                <query>
                    | makeresults
                    | addinfo
                    | eval StartDate = strftime(info_min_time, "%b %e,%Y %I:%M%p"), EndDate = strftime(info_max_time,
                    "%b %e,%Y %I:%M%p")
                </query>
                <earliest>$errors_time.earliest$</earliest>
                <latest>$errors_time.latest$</latest>
                <done>
                    <set token="errors_start">$result.StartDate$</set>
                    <set token="errors_end">$result.EndDate$</set>
                </done>
            </search>
            <html>$errors_start$ - $errors_end$</html>
        </panel>
        <panel id="errors_input_panel">
            <input id="errors_input" type="time" token="errors_time">
                <label>Time:</label>
                <default>
                    <earliest>-7d</earliest>
                    <latest>now</latest>
                </default>
            </input>
        </panel>
    </row>
    <row id="error_tab_row">
        <panel id="error_tab_panel">
            <title>Errors in the add-on</title>
            <event>
                <search>
                    <query>{{ errors_list }}</query>
                    <earliest>$errors_time.earliest$</earliest>
                    <latest>$errors_time.latest$</latest>
                </search>
                <option name="list.drilldown">none</option>
                <option name="maxLines">10</option>
                <option name="raw.drilldown">none</option>
                <option name="refresh.display">progressbar</option>
                <option name="rowNumbers">0</option>
                <option name="type">list</option>
            </event>
        </panel>
    </row>
</form>