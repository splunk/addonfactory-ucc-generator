{
  "visualizations": {
    "spike_modal_timerange_label_start_viz": {
      "type": "splunk.singlevalue",
      "options": {
        "majorFontSize": 12,
        "backgroundColor": "transparent",
        "majorColor": "#9fa4af"
      },
      "dataSources": {
        "primary": "spike_modal_data_time_label_start_ds"
      }
    },
    "spike_modal_timerange_label_end_viz": {
      "type": "splunk.singlevalue",
      "options": {
        "majorFontSize": 12,
        "backgroundColor": "transparent",
        "majorColor": "#9fa4af"
      },
      "dataSources": {
        "primary": "spike_modal_data_time_label_end_ds"
      }
    },
    "spike_modal_data_volume_viz": {
      "type": "splunk.line",
      "options": {
        "xAxisVisibility": "hide",
        "seriesColors": ["#A870EF"],
        "yAxisTitleText": "Volume (bytes)",
        "xAxisTitleText": "Time"
      },
      "title": "Data volume",
      "dataSources": {
        "primary": "spike_modal_data_volume_ds"
      }
    },
    "spike_modal_events_count_viz": {
      "type": "splunk.line",
      "options": {
        "xAxisVisibility": "hide",
        "xAxisTitleText": "Time",
        "seriesColors": ["#A870EF"],
        "yAxisTitleText": "Number of events"
      },
      "title": "Number of events",
      "dataSources": {
        "primary": "ds_search_1"
      }
    }
  },
  "dataSources": {
    "spike_modal_data_time_label_start_ds": {
      "type": "ds.search",
      "options": {
        "query": "| makeresults | addinfo | eval StartDate = strftime(info_min_time, \"%e %b %Y %I:%M%p\") | table StartDate",
        "queryParameters": {
          "earliest": "$spike_modal_time.earliest$",
          "latest": "$spike_modal_time.latest$"
        }
      }
    },
    "spike_modal_data_time_label_end_ds": {
      "type": "ds.search",
      "options": {
        "query": "| makeresults | addinfo | eval EndDate = strftime(info_max_time, \"%e %b %Y %I:%M%p\") | table EndDate",
        "queryParameters": {
          "earliest": "$spike_modal_time.earliest$",
          "latest": "$spike_modal_time.latest$"
        }
      }
    },
    "spike_modal_data_volume_ds": {
      "type": "ds.search",
      "options": {
        "query": "| inputlookup firewall_example.csv \n| search host=host8 OR host=host18\n| eval host=case(host=\"host8\", \"spend\", host=\"host18\", \"score\", 1=1, host)\n| eval myTime=strftime(timestamp,\"%H:%M\") \n| chart count over myTime by host\n| eval score=score*2\n| eval spend=spend*1500\n| fields myTime spend score\n| rename score as \"Security Score\", spend as \"Security Spend\"",
        "queryParameters": {
          "earliest": "$spike_modal_time.earliest$",
          "latest": "$spike_modal_time.latest$"
        }
      }
    },
    "ds_search_1": {
      "type": "ds.search",
      "options": {
        "query": "| inputlookup firewall_example.csv \n| search host=host8 OR host=host18\n| eval host=case(host=\"host8\", \"spend\", host=\"host18\", \"score\", 1=1, host)\n| eval myTime=strftime(timestamp,\"%H:%M\") \n| chart count over myTime by host\n| eval score=score*2\n| eval spend=spend*1500\n| fields myTime spend score\n| rename score as \"Security Score\", spend as \"Security Spend\"",
        "queryParameters": {
          "earliest": "$spike_modal_time.earliest$",
          "latest": "$spike_modal_time.latest$"
        }
      },
      "name": "Security Score vs Spend"
    }
  },
  "defaults": {},
  "inputs": {
    "input1": {
      "type": "input.dropdown",
      "options": {
        "items": [
          {
            "label": "Source type",
            "value": "Source type"
          },
          {
            "label": "Source",
            "value": "Source"
          },
          {
            "label": "Host",
            "value": "Host"
          }
        ],
        "defaultValue": "Source type",
        "token": "spike_view_by"
      },
      "title": "Input"
    },
    "spike_modal_input": {
      "options": {
        "defaultValue": "-24h,now",
        "token": "spike_modal_time"
      },
      "title": "Time Window",
      "type": "input.timerange"
    }
  },
  "layout": {
    "type": "grid",
    "globalInputs": ["spike_modal_input", "input1"],
    "structure": [
      {
        "item": "spike_modal_timerange_label_start_viz",
        "position": {
          "x": 20,
          "y": 0,
          "w": 100,
          "h": 20
        }
      },
      {
        "item": "spike_modal_timerange_label_end_viz",
        "position": {
          "x": 120,
          "y": 0,
          "w": 100,
          "h": 20
        }
      },
      {
        "item": "spike_modal_data_volume_viz",
        "position": {
          "x": 20,
          "y": 100,
          "w": 300,
          "h": 400
        }
      },
      {
        "item": "spike_modal_events_count_viz",
        "position": {
          "x": 20,
          "y": 550,
          "w": 300,
          "h": 400
        }
      }
    ]
  }
}
